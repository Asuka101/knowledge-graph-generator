len*=2;
}
delete [] R;  //释放R数组所占用的动态存储空间
}

二路归并排序的时间复杂度等于归并趟数与每一趟时间复杂度的乘积。归并趟数为$\lceil \lg n \rceil$(当$\lceil \lg n \rceil$为奇数时，则为$\lfloor \lg n \rfloor +1$)。因为每一趟归并就是将两两有序表归并，而每一对有序表归并时，记录的比较次数均小于等于记录的移动次数（即由一个数组复制到另一个数组中的记录个数），而记录的移动次数等于这一对有序表的长度之和，所以每一趟归并的移动次数均等于数组中记录的个数$n$，即每一趟归并的时间复杂度为$O(n)$。因此，二路归并排序的时间复杂度为$O(n\lg n)$。

二路归并排序时需要利用同待排序数组一样大小的一个辅助数组，所以其空间复杂度为$O(n)$。显然它高于前面所有排序算法的空间复杂度。

二路归并排序是稳定的，因为在每两个有序表归并时，若分别在两个有序表中出现有相同排序码的元素，TwoMerge 算法能够使前一有序表中同一排序码的元素先被复制，后一有序表中同一排序码的元素后被复制，从而确保它们的相对次序不会改变。

*10.6 各种内排序方法的比较

各种内排序方法之间的比较，主要从时间复杂度、空间复杂度、稳定性、算法简单性、待排序记录数$n$的大小和记录本身信息量的大小等方面综合考虑。

下面先从每个方面进行比较和分析，然后再给出综合结论。

1. 时间复杂度

从时间复杂度看，直接插入排序、直接选择排序和气泡排序这3种简单排序方法属于一类，其时间复杂度为$O(n^2)$；堆排序、快速排序和归并排序这3种排序方法属于第2类，其时间复杂度为$O(n\lg n)$；希尔排序介于这两者之间。这种分类只是就平均情况而言，若从最好情况考虑，则直接插入排序和气泡排序的时间复杂度最好，为$O(n)$，其他算法的最好情况同相应的平均情况相同。若从最坏情况考虑，则快速排序的时间复杂度为$O(n^2)$，直接插入排序、希尔排序和气泡排序虽然同相应的平均情况下相同，但系数大约增加一倍，所以运行速度将降低一半，最坏情况对直接选择排序、堆排序和归并排序影响不大。若再考虑各种排序算法的时间复杂度的系数，则在第1类算法中，直接插入排序的系数最小，直接选择排序次之（但它的移动次数最小），气泡排序最大，所以直接插入排序和直接选择排序比气泡排序速度快；在第2类算法中，快速排序的系数最小，堆排序和归并排序次之，所以快速排序比堆排序和归并排序速度快。由此可知，在最好情况下，直接插入排序和气泡排序最快；在平均情况下，快速排序最快；在最坏情况下，堆排序和归并排序最快。

2. 空间复杂度

从空间复杂度看，所有排序方法可归为3类，归并排序单独属于一类，其空间复杂
